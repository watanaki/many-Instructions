# æ•°æ®ç±»å‹



## Scalaræ ‡é‡

---

**æ ‡é‡**ï¼ˆ*scalar*ï¼‰ç±»å‹ä»£è¡¨ä¸€ä¸ªå•ç‹¬çš„å€¼ã€‚Rust æœ‰å››ç§åŸºæœ¬çš„æ ‡é‡ç±»å‹ï¼šæ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”ç±»å‹å’Œå­—ç¬¦ç±»å‹ã€‚



### æ•´å‹

---

>  Rust ä¸­çš„æ•´å‹

| é•¿åº¦    | æœ‰ç¬¦å·  | æ— ç¬¦å·  |
| ------- | ------- | ------- |
| 8-bit   | `i8`    | `u8`    |
| 16-bit  | `i16`   | `u16`   |
| 32-bit  | `i32`   | `u32`   |
| 64-bit  | `i64`   | `u64`   |
| 128-bit | `i128`  | `u128`  |
| arch    | `isize` | `usize` |

==æ•´å½¢å‹é»˜è®¤i32==

`isize` å’Œ `usize` ç±»å‹ä¾èµ–è¿è¡Œç¨‹åºçš„è®¡ç®—æœºæ¶æ„ï¼š64 ä½æ¶æ„ä¸Šå®ƒä»¬æ˜¯ 64 ä½çš„ï¼Œ32 ä½æ¶æ„ä¸Šå®ƒä»¬æ˜¯ 32 ä½çš„ã€‚

å¯ä»¥ä½¿ç”¨è¡¨æ ¼ 3-2 ä¸­çš„ä»»ä½•ä¸€ç§å½¢å¼ç¼–å†™æ•°å­—å­—é¢å€¼ã€‚è¯·æ³¨æ„å¯ä»¥æ˜¯å¤šç§æ•°å­—ç±»å‹çš„æ•°å­—å­—é¢å€¼å…è®¸ä½¿ç”¨ç±»å‹åç¼€ï¼Œä¾‹å¦‚ `57u8` æ¥æŒ‡å®šç±»å‹ï¼ŒåŒæ—¶ä¹Ÿå…è®¸ä½¿ç”¨ `_` åšä¸ºåˆ†éš”ç¬¦ä»¥æ–¹ä¾¿è¯»æ•°ï¼Œä¾‹å¦‚`1_000`ï¼Œå®ƒçš„å€¼ä¸ä½ æŒ‡å®šçš„ `1000` ç›¸åŒã€‚



> Rust ä¸­çš„æ•´å‹å­—é¢å€¼

|          æ•°å­—å­—é¢å€¼           | ä¾‹å­          |
| :---------------------------: | ------------- |
|       Decimal (åè¿›åˆ¶)        | `98_222`      |
|     Hex (åå…­è¿›åˆ¶)  (0x)      | `0xff`        |
|     Octal (å…«è¿›åˆ¶)  (0o)      | `0o77`        |
|     Binary (äºŒè¿›åˆ¶)  (0b)     | `0b1111_0000` |
| Byte (å•å­—èŠ‚å­—ç¬¦)(ä»…é™äº`u8`) | `b'A'`        |

é‚£ä¹ˆè¯¥ä½¿ç”¨å“ªç§ç±»å‹çš„æ•°å­—å‘¢ï¼Ÿå¦‚æœæ‹¿ä¸å®šä¸»æ„ï¼ŒRust çš„é»˜è®¤ç±»å‹é€šå¸¸æ˜¯ä¸ªä¸é”™çš„èµ·ç‚¹ï¼Œæ•°å­—ç±»å‹é»˜è®¤æ˜¯ `i32`ã€‚`isize` æˆ– `usize` ä¸»è¦ä½œä¸ºæŸäº›é›†åˆçš„ç´¢å¼•ã€‚

[integer overflow(æ•´å‹æº¢å‡º)](https://kaisery.github.io/trpl-zh-cn/ch03-02-data-types.html#%E6%95%B4%E5%9E%8B%E6%BA%A2%E5%87%BA)



### æµ®ç‚¹å‹

---

Rust ä¹Ÿæœ‰ä¸¤ä¸ªåŸç”Ÿçš„ **æµ®ç‚¹æ•°**ï¼ˆ*floating-point numbers*ï¼‰ç±»å‹ï¼Œå®ƒä»¬æ˜¯å¸¦å°æ•°ç‚¹çš„æ•°å­—ã€‚Rust çš„æµ®ç‚¹æ•°ç±»å‹æ˜¯ `f32` å’Œ `f64`ï¼Œåˆ†åˆ«å  32 ä½å’Œ 64 ä½ã€‚é»˜è®¤ç±»å‹æ˜¯ `f64`ï¼Œå› ä¸ºåœ¨ç°ä»£ CPU ä¸­ï¼Œå®ƒä¸ `f32` é€Ÿåº¦å‡ ä¹ä¸€æ ·ï¼Œä¸è¿‡ç²¾åº¦æ›´é«˜ã€‚æ‰€æœ‰çš„æµ®ç‚¹å‹éƒ½æ˜¯æœ‰ç¬¦å·çš„ã€‚

~~~rust
fn main() {
    let x = 2.0; // f64

    let y: f32 = 3.0; // f32
}
~~~



### å¸ƒå°”å‹

---

æ­£å¦‚å…¶ä»–å¤§éƒ¨åˆ†ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼ŒRust ä¸­çš„å¸ƒå°”ç±»å‹æœ‰ä¸¤ä¸ªå¯èƒ½çš„å€¼ï¼š`true` å’Œ `false`ã€‚Rust ä¸­çš„å¸ƒå°”ç±»å‹ä½¿ç”¨ `bool` è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼š

~~~rust
fn main() {
    let t = true;

    let f: bool = false; // with explicit type annotation
}
~~~



### å­—ç¬¦ç±»å‹

---

Rust çš„ `char` ç±»å‹æ˜¯è¯­è¨€ä¸­æœ€åŸç”Ÿçš„å­—æ¯ç±»å‹ã€‚ä¸‹é¢æ˜¯ä¸€äº›å£°æ˜ `char` å€¼çš„ä¾‹å­ï¼š

~~~rust
fn main() {
    let c = 'z';
    let z: char = 'â„¤'; // with explicit type annotation
    let heart_eyed_cat = 'ğŸ˜»';
}
~~~

æ³¨æ„ï¼Œæˆ‘ä»¬ç”¨å•å¼•å·å£°æ˜ `char` å­—é¢é‡ï¼Œè€Œä¸ä¹‹ç›¸åçš„æ˜¯ï¼Œä½¿ç”¨åŒå¼•å·å£°æ˜å­—ç¬¦ä¸²å­—é¢é‡ã€‚Rust çš„ `char` ç±»å‹çš„å¤§å°ä¸ºå››ä¸ªå­—èŠ‚ (four bytes)ï¼Œå¹¶ä»£è¡¨äº†ä¸€ä¸ª Unicode æ ‡é‡å€¼ï¼ˆUnicode Scalar Valueï¼‰ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥æ¯” ASCII è¡¨ç¤ºæ›´å¤šå†…å®¹ã€‚åœ¨ Rust ä¸­ï¼Œå¸¦å˜éŸ³ç¬¦å·çš„å­—æ¯ï¼ˆAccented lettersï¼‰ï¼Œä¸­æ–‡ã€æ—¥æ–‡ã€éŸ©æ–‡ç­‰å­—ç¬¦ï¼Œemojiï¼ˆç»˜æ–‡å­—ï¼‰ä»¥åŠé›¶é•¿åº¦çš„ç©ºç™½å­—ç¬¦éƒ½æ˜¯æœ‰æ•ˆçš„ `char` å€¼ã€‚Unicode æ ‡é‡å€¼åŒ…å«ä» `U+0000` åˆ° `U+D7FF` å’Œ `U+E000` åˆ° `U+10FFFF` åœ¨å†…çš„å€¼ã€‚ä¸è¿‡ï¼Œâ€œå­—ç¬¦â€ å¹¶ä¸æ˜¯ä¸€ä¸ª Unicode ä¸­çš„æ¦‚å¿µï¼Œæ‰€ä»¥äººç›´è§‰ä¸Šçš„ â€œå­—ç¬¦â€ å¯èƒ½ä¸ Rust ä¸­çš„ `char` å¹¶ä¸ç¬¦åˆã€‚ç¬¬å…«ç« çš„ [â€œä½¿ç”¨å­—ç¬¦ä¸²å‚¨å­˜ UTF-8 ç¼–ç çš„æ–‡æœ¬â€](https://kaisery.github.io/trpl-zh-cn/ch08-02-strings.html#ä½¿ç”¨å­—ç¬¦ä¸²å‚¨å­˜-utf-8-ç¼–ç çš„æ–‡æœ¬) ä¸­å°†è¯¦ç»†è®¨è®ºè¿™ä¸ªä¸»é¢˜ã€‚



## Compound typeå¤åˆç±»å‹

---

**å¤åˆç±»å‹**ï¼ˆ*Compound types*ï¼‰å¯ä»¥å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ã€‚Rust æœ‰ä¸¤ä¸ªåŸç”Ÿçš„å¤åˆç±»å‹ï¼šå…ƒç»„ï¼ˆtupleï¼‰å’Œæ•°ç»„ï¼ˆarrayï¼‰ã€‚



### tuple

---

å…ƒç»„æ˜¯ä¸€ä¸ªå°†å¤šä¸ªå…¶ä»–ç±»å‹çš„å€¼ç»„åˆè¿›ä¸€ä¸ªå¤åˆç±»å‹çš„ä¸»è¦æ–¹å¼ã€‚==å…ƒç»„é•¿åº¦å›ºå®šï¼šä¸€æ—¦å£°æ˜ï¼Œå…¶é•¿åº¦ä¸ä¼šå¢å¤§æˆ–ç¼©å°ã€‚==

å…ƒç»„å†…å…ƒç´ ç±»å‹å¯ä¸ç›¸åŒ:

~~~rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
}
~~~

å…ƒç»„æ”¯æŒè§£æ„:

~~~rust
fn main() {
    let tup = (500, 6.4, 1);
    let (x, y, z) = tup;
    println!("The value of y is: {y}");
}
~~~

å¯ä½¿ç”¨`.`è®¿é—®å…ƒç»„å†…å…ƒç´ :

~~~rust
fn main() {
    let x: (i32, f64, u8) = (500, 6.4, 1);

    let five_hundred = x.0;

    let six_point_four = x.1;

    let one = x.2;
}
~~~

ä¸å¸¦ä»»ä½•å€¼çš„å…ƒç»„æœ‰ä¸ªç‰¹æ®Šçš„åç§°ï¼Œå«åš **å•å…ƒï¼ˆunitï¼‰** å…ƒç»„ã€‚è¿™ç§å€¼ä»¥åŠå¯¹åº”çš„ç±»å‹éƒ½å†™ä½œ `()`ï¼Œè¡¨ç¤ºç©ºå€¼æˆ–ç©ºçš„è¿”å›ç±»å‹ã€‚å¦‚æœè¡¨è¾¾å¼ä¸è¿”å›ä»»ä½•å…¶ä»–å€¼ï¼Œåˆ™ä¼šéšå¼è¿”å›å•å…ƒå€¼ã€‚



### array

---

å¦ä¸€ä¸ªåŒ…å«å¤šä¸ªå€¼çš„æ–¹å¼æ˜¯ **æ•°ç»„**ï¼ˆ*array*ï¼‰ã€‚ä¸å…ƒç»„ä¸åŒï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ çš„ç±»å‹å¿…é¡»ç›¸åŒã€‚Rust ä¸­çš„æ•°ç»„é•¿åº¦æ˜¯å›ºå®šçš„ã€‚

å¯ä»¥åƒè¿™æ ·ç¼–å†™æ•°ç»„çš„ç±»å‹ï¼šåœ¨æ–¹æ‹¬å·ä¸­åŒ…å«æ¯ä¸ªå…ƒç´ çš„ç±»å‹ï¼Œåè·Ÿåˆ†å·ï¼Œå†åè·Ÿæ•°ç»„å…ƒç´ çš„æ•°é‡:

~~~rust
let a: [i32; 5] = [1, 2, 3, 4, 5];
//i32æ˜¯æ¯ä¸ªå…ƒç´ çš„ç±»å‹ã€‚åˆ†å·ä¹‹åï¼Œæ•°å­—5è¡¨æ˜è¯¥æ•°ç»„åŒ…å«äº”ä¸ªå…ƒç´ 
~~~

ä½ è¿˜å¯ä»¥é€šè¿‡åœ¨æ–¹æ‹¬å·ä¸­æŒ‡å®šåˆå§‹å€¼åŠ åˆ†å·å†åŠ å…ƒç´ ä¸ªæ•°çš„æ–¹å¼æ¥åˆ›å»ºä¸€ä¸ªæ¯ä¸ªå…ƒç´ éƒ½ä¸ºç›¸åŒå€¼çš„æ•°ç»„ï¼š

```rust
let a = [3; 5];
```

å˜é‡åä¸º `a` çš„æ•°ç»„å°†åŒ…å« `5` ä¸ªå…ƒç´ ï¼Œè¿™äº›å…ƒç´ çš„å€¼æœ€åˆéƒ½å°†è¢«è®¾ç½®ä¸º `3`ã€‚è¿™ç§å†™æ³•ä¸ `let a = [3, 3, 3, 3, 3];` æ•ˆæœç›¸åŒï¼Œä½†æ›´ç®€æ´ã€‚



# å‡½æ•°

[å‡½æ•°](https://kaisery.github.io/trpl-zh-cn/ch03-03-how-functions-work.html#%E5%87%BD%E6%95%B0)

åœ¨å‡½æ•°ç­¾åä¸­ï¼Œ**å¿…é¡»** å£°æ˜æ¯ä¸ªå‚æ•°çš„ç±»å‹,å¦åˆ™å°†é€šä¸è¿‡ç¼–è¯‘.



# è¯­å¥å’Œè¡¨è¾¾å¼

**è¯­å¥**ï¼ˆ*Statements*ï¼‰æ˜¯æ‰§è¡Œä¸€äº›æ“ä½œä½†ä¸è¿”å›å€¼çš„æŒ‡ä»¤ã€‚ **è¡¨è¾¾å¼**ï¼ˆ*Expressions*ï¼‰è®¡ç®—å¹¶äº§ç”Ÿä¸€ä¸ªå€¼ã€‚è®©æˆ‘ä»¬çœ‹ä¸€äº›ä¾‹å­ã€‚

ä½¿ç”¨ `let` å…³é”®å­—åˆ›å»ºå˜é‡å¹¶ç»‘å®šä¸€ä¸ªå€¼æ˜¯ä¸€ä¸ªè¯­å¥ã€‚

```rust
fn main() {
    let y = 6;	//è¯­å¥
}
```

å‡½æ•°å®šä¹‰ä¹Ÿæ˜¯è¯­å¥ï¼Œä¸Šé¢æ•´ä¸ªä¾‹å­æœ¬èº«å°±æ˜¯ä¸€ä¸ªè¯­å¥ã€‚

è¯­å¥ä¸è¿”å›å€¼ã€‚å› æ­¤ï¼Œä¸èƒ½æŠŠ `let` è¯­å¥èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­å°è¯•åšçš„ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ï¼š

```rust
fn main() {
    let x = (let y = 6);
}
```

å½“è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ï¼Œä¼šå¾—åˆ°å¦‚ä¸‹é”™è¯¯ï¼š

```console
$ cargo run
   Compiling functions v0.1.0 (file:///projects/functions)
error: expected expression, found `let` statement
 --> src/main.rs:2:14
  |
2 |     let x = (let y = 6);
  |              ^^^
error: expected expression, found statement (`let`)
```

`let y = 6` è¯­å¥å¹¶ä¸è¿”å›å€¼ï¼Œæ‰€ä»¥æ²¡æœ‰å¯ä»¥ç»‘å®šåˆ° `x` ä¸Šçš„å€¼ã€‚è¿™ä¸å…¶ä»–è¯­è¨€ä¸åŒï¼Œä¾‹å¦‚ C å’Œ Rubyï¼Œå®ƒä»¬çš„èµ‹å€¼è¯­å¥ä¼šè¿”å›æ‰€èµ‹çš„å€¼ã€‚åœ¨è¿™äº›è¯­è¨€ä¸­ï¼Œå¯ä»¥è¿™ä¹ˆå†™ `x = y = 6`ï¼Œè¿™æ · `x` å’Œ `y` çš„å€¼éƒ½æ˜¯ `6`ï¼›Rustä¸­ä¸èƒ½è¿™ä¹ˆåš.

---



è¡¨è¾¾å¼ä¼šè®¡ç®—å‡ºä¸€ä¸ªå€¼ï¼Œå¹¶ä¸”ä½ å°†ç¼–å†™çš„å¤§éƒ¨åˆ† Rust ä»£ç æ˜¯ç”±è¡¨è¾¾å¼ç»„æˆçš„ã€‚è€ƒè™‘ä¸€ä¸ªæ•°å­¦è¿ç®—ï¼Œæ¯”å¦‚ `5 + 6`ï¼Œè¿™æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼å¹¶è®¡ç®—å‡ºå€¼ `11`ã€‚è¡¨è¾¾å¼å¯ä»¥æ˜¯è¯­å¥çš„ä¸€éƒ¨åˆ†ï¼šåœ¨ç¤ºä¾‹ 3-1 ä¸­ï¼Œè¯­å¥ `let y = 6;` ä¸­çš„ `6` æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå®ƒè®¡ç®—å‡ºçš„å€¼æ˜¯ `6`ã€‚å‡½æ•°è°ƒç”¨æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚å®è°ƒç”¨æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚==ç”¨å¤§æ‹¬å·åˆ›å»ºçš„ä¸€ä¸ªæ–°çš„å—ä½œç”¨åŸŸä¹Ÿæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼==ï¼Œä¾‹å¦‚ï¼š

```rust
fn main() {
    let y = {
        let x = 3;
        x + 1
    };
    println!("The value of y is: {y}");
}
```

è¿™ä¸ªè¡¨è¾¾å¼ï¼š

```rust
{
    let x = 3;
    x + 1
}
```

æ˜¯ä¸€ä¸ªä»£ç å—ï¼Œå®ƒçš„å€¼æ˜¯ `4`ã€‚è¿™ä¸ªå€¼ä½œä¸º `let` è¯­å¥çš„ä¸€éƒ¨åˆ†è¢«ç»‘å®šåˆ° `y` ä¸Šã€‚æ³¨æ„ `x+1` è¿™ä¸€è¡Œåœ¨ç»“å°¾æ²¡æœ‰åˆ†å·ï¼Œä¸ä½ è§è¿‡çš„å¤§éƒ¨åˆ†ä»£ç è¡Œä¸åŒã€‚è¡¨è¾¾å¼çš„ç»“å°¾æ²¡æœ‰åˆ†å·ã€‚å¦‚æœåœ¨è¡¨è¾¾å¼çš„ç»“å°¾åŠ ä¸Šåˆ†å·ï¼Œå®ƒå°±å˜æˆäº†è¯­å¥ï¼Œè€Œè¯­å¥ä¸ä¼šè¿”å›å€¼ã€‚åœ¨æ¥ä¸‹æ¥æ¢ç´¢å…·æœ‰è¿”å›å€¼çš„å‡½æ•°å’Œè¡¨è¾¾å¼æ—¶è¦è°¨è®°è¿™ä¸€ç‚¹ã€‚

# å…·æœ‰è¿”å›å€¼çš„å‡½æ•°

å‡½æ•°å¯ä»¥å‘è°ƒç”¨å®ƒçš„ä»£ç è¿”å›å€¼ã€‚æˆ‘ä»¬å¹¶ä¸å¯¹è¿”å›å€¼å‘½åï¼Œä½†è¦åœ¨ç®­å¤´ï¼ˆ`->`ï¼‰åå£°æ˜å®ƒçš„ç±»å‹ã€‚åœ¨ Rust ä¸­ï¼Œå‡½æ•°çš„è¿”å›å€¼ç­‰åŒäºå‡½æ•°ä½“æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚ä½¿ç”¨ `return` å…³é”®å­—å’ŒæŒ‡å®šå€¼ï¼Œå¯ä»å‡½æ•°ä¸­æå‰è¿”å›ï¼›==ä½†å¤§éƒ¨åˆ†å‡½æ•°éšå¼çš„è¿”å›æœ€åçš„è¡¨è¾¾å¼==ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰è¿”å›å€¼çš„å‡½æ•°çš„ä¾‹å­ï¼š

```rust
fn five() -> i32 {
    5
}

fn main() {
    let x = five();
    println!("The value of x is: {x}");
}
```

åœ¨ `five` å‡½æ•°ä¸­æ²¡æœ‰å‡½æ•°è°ƒç”¨ã€å®ã€ç”šè‡³æ²¡æœ‰ `let` è¯­å¥ â€”â€” åªæœ‰æ•°å­— `5`ã€‚è¿™åœ¨ Rust ä¸­æ˜¯ä¸€ä¸ªå®Œå…¨æœ‰æ•ˆçš„å‡½æ•°ã€‚æ³¨æ„ï¼Œä¹ŸæŒ‡å®šäº†å‡½æ•°è¿”å›å€¼çš„ç±»å‹ï¼Œå°±æ˜¯ `-> i32`ã€‚å°è¯•è¿è¡Œä»£ç ï¼›è¾“å‡ºåº”è¯¥çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```console
$ cargo run
   Compiling functions v0.1.0 (file:///projects/functions)
    Finished dev [unoptimized + debuginfo] target(s) in 0.30s
     Running `target/debug/functions`
The value of x is: 5
```

`five` å‡½æ•°çš„è¿”å›å€¼æ˜¯ `5`ï¼Œæ‰€ä»¥è¿”å›å€¼ç±»å‹æ˜¯ `i32`ã€‚è®©æˆ‘ä»¬ä»”ç»†æ£€æŸ¥ä¸€ä¸‹è¿™æ®µä»£ç ã€‚æœ‰ä¸¤ä¸ªé‡è¦çš„éƒ¨åˆ†ï¼šé¦–å…ˆï¼Œ`let x = five();` è¿™ä¸€è¡Œè¡¨æ˜æˆ‘ä»¬ä½¿ç”¨å‡½æ•°çš„è¿”å›å€¼åˆå§‹åŒ–ä¸€ä¸ªå˜é‡ã€‚å› ä¸º `five` å‡½æ•°è¿”å› `5`ï¼Œè¿™ä¸€è¡Œä¸å¦‚ä¸‹ä»£ç ç›¸åŒï¼š

```rust
let x = 5;
```

å…¶æ¬¡ï¼Œ`five` å‡½æ•°æ²¡æœ‰å‚æ•°å¹¶å®šä¹‰äº†è¿”å›å€¼ç±»å‹ï¼Œä¸è¿‡å‡½æ•°ä½“åªæœ‰å•å•ä¸€ä¸ª `5` ä¹Ÿæ²¡æœ‰åˆ†å·ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬æƒ³è¦è¿”å›å®ƒçš„å€¼ã€‚

---


è®©æˆ‘ä»¬çœ‹çœ‹å¦ä¸€ä¸ªä¾‹å­ï¼š

```rust
fn main() {
    let x = plus_one(5);
    println!("The value of x is: {x}");
}

fn plus_one(x: i32) -> i32 {
    x + 1
}
```

è¿è¡Œä»£ç ä¼šæ‰“å°å‡º `The value of x is: 6`ã€‚ä½†å¦‚æœåœ¨åŒ…å« `x + 1` çš„è¡Œå°¾åŠ ä¸Šä¸€ä¸ªåˆ†å·ï¼ŒæŠŠå®ƒä»è¡¨è¾¾å¼å˜æˆè¯­å¥ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä¸€ä¸ªé”™è¯¯ã€‚

```rust
fn main() {
    let x = plus_one(5);
    println!("The value of x is: {x}");
}

fn plus_one(x: i32) -> i32 {
    x + 1;
}
```

è¿è¡Œä»£ç ä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ï¼Œå¦‚ä¸‹ï¼š

```console
$ cargo run
   Compiling functions v0.1.0 (file:///projects/functions)
error[E0308]: mismatched types
 --> src/main.rs:7:24
  |
7 | fn plus_one(x: i32) -> i32 {
  |    --------            ^^^ expected `i32`, found `()`
  |    |
  |    implicitly returns `()` as its body has no tail or `return` expression
8 |     x + 1;
  |          - help: remove this semicolon

For more information about this error, try `rustc --explain E0308`.
error: could not compile `functions` due to previous error
```

ä¸»è¦çš„é”™è¯¯ä¿¡æ¯ï¼Œâ€œmismatched typesâ€ï¼ˆç±»å‹ä¸åŒ¹é…ï¼‰ï¼Œæ­ç¤ºäº†ä»£ç çš„æ ¸å¿ƒé—®é¢˜ã€‚å‡½æ•° `plus_one` çš„å®šä¹‰è¯´æ˜å®ƒè¦è¿”å›ä¸€ä¸ª `i32` ç±»å‹çš„å€¼ï¼Œä¸è¿‡è¯­å¥å¹¶ä¸ä¼šè¿”å›å€¼ï¼Œä½¿ç”¨å•ä½ç±»å‹ `()` è¡¨ç¤ºä¸è¿”å›å€¼ã€‚å› ä¸ºä¸è¿”å›å€¼ä¸å‡½æ•°å®šä¹‰ç›¸çŸ›ç›¾ï¼Œä»è€Œå‡ºç°ä¸€ä¸ªé”™è¯¯ã€‚åœ¨è¾“å‡ºä¸­ï¼ŒRust æä¾›äº†ä¸€æ¡ä¿¡æ¯ï¼Œå¯èƒ½æœ‰åŠ©äºçº æ­£è¿™ä¸ªé”™è¯¯ï¼šå®ƒå»ºè®®åˆ é™¤åˆ†å·ï¼Œè¿™ä¼šä¿®å¤è¿™ä¸ªé”™è¯¯ã€‚



# ifè¡¨è¾¾å¼å’Œå¾ªç¯

[æ§åˆ¶æµ](https://kaisery.github.io/trpl-zh-cn/ch03-05-control-flow.html)

[ä»å¾ªç¯è¿”å›å€¼](https://kaisery.github.io/trpl-zh-cn/ch03-05-control-flow.html#%E4%BB%8E%E5%BE%AA%E7%8E%AF%E8%BF%94%E5%9B%9E%E5%80%BC)



# æ‰€æœ‰æƒ

æ‰€æœ‰ç¨‹åºéƒ½å¿…é¡»ç®¡ç†å…¶è¿è¡Œæ—¶ä½¿ç”¨è®¡ç®—æœºå†…å­˜çš„æ–¹å¼ã€‚ä¸€äº›è¯­è¨€ä¸­å…·æœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶æœ‰è§„å¾‹åœ°å¯»æ‰¾ä¸å†ä½¿ç”¨çš„å†…å­˜ï¼›åœ¨å¦ä¸€äº›è¯­è¨€ä¸­ï¼Œç¨‹åºå‘˜å¿…é¡»äº²è‡ªåˆ†é…å’Œé‡Šæ”¾å†…å­˜ã€‚Rust åˆ™é€‰æ‹©äº†ç¬¬ä¸‰ç§æ–¹å¼ï¼šé€šè¿‡æ‰€æœ‰æƒç³»ç»Ÿç®¡ç†å†…å­˜ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ä¼šæ ¹æ®ä¸€ç³»åˆ—çš„è§„åˆ™è¿›è¡Œæ£€æŸ¥ã€‚å¦‚æœè¿åäº†ä»»ä½•è¿™äº›è§„åˆ™ï¼Œç¨‹åºéƒ½ä¸èƒ½ç¼–è¯‘ã€‚åœ¨è¿è¡Œæ—¶ï¼Œæ‰€æœ‰æƒç³»ç»Ÿçš„ä»»ä½•åŠŸèƒ½éƒ½ä¸ä¼šå‡æ…¢ç¨‹åºã€‚

## Stack and Heap

---

â€‹	æ ˆä¸­çš„æ‰€æœ‰æ•°æ®éƒ½å¿…é¡»å ç”¨å·²çŸ¥ä¸”å›ºå®šçš„å¤§å°ã€‚åœ¨ç¼–è¯‘æ—¶å¤§å°æœªçŸ¥æˆ–å¤§å°å¯èƒ½å˜åŒ–çš„æ•°æ®ï¼Œè¦æ”¹ä¸ºå­˜å‚¨åœ¨å †ä¸Šã€‚

â€‹	å †æ˜¯ç¼ºä¹ç»„ç»‡çš„ï¼šå½“å‘å †æ”¾å…¥æ•°æ®æ—¶ï¼Œä½ è¦è¯·æ±‚ä¸€å®šå¤§å°çš„ç©ºé—´ã€‚å†…å­˜åˆ†é…å™¨ï¼ˆmemory allocatorï¼‰åœ¨å †çš„æŸå¤„æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºä½ï¼ŒæŠŠå®ƒæ ‡è®°ä¸ºå·²ä½¿ç”¨ï¼Œå¹¶è¿”å›ä¸€ä¸ªè¡¨ç¤ºè¯¥ä½ç½®åœ°å€çš„ **æŒ‡é’ˆ**ï¼ˆ*pointer*ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä½œ **åœ¨å †ä¸Šåˆ†é…å†…å­˜**ï¼ˆ*allocating on the heap*ï¼‰ï¼Œæœ‰æ—¶ç®€ç§°ä¸º â€œåˆ†é…â€ï¼ˆallocatingï¼‰ã€‚ï¼ˆå°†æ•°æ®æ¨å…¥æ ˆä¸­å¹¶ä¸è¢«è®¤ä¸ºæ˜¯åˆ†é…ï¼‰ã€‚

â€‹	å› ä¸ºæŒ‡å‘æ”¾å…¥å †ä¸­æ•°æ®çš„æŒ‡é’ˆæ˜¯å·²çŸ¥çš„å¹¶ä¸”å¤§å°æ˜¯å›ºå®šçš„ï¼Œä½ å¯ä»¥å°†è¯¥æŒ‡é’ˆå­˜å‚¨åœ¨æ ˆä¸Šï¼Œå½“éœ€è¦è®¿é—®å‚¨å­˜åœ¨å †ä¸Šçš„æ•°æ®æ—¶, è¦ä»æ ˆä¸Šæ‹¿åˆ°å¯¹åº”æŒ‡é’ˆ,æ ¹æ®æŒ‡é’ˆè®¿é—®å†…å­˜æ‹¿å–æ•°æ®.

â€‹	**å…¥æ ˆæ¯”åœ¨å †ä¸Šåˆ†é…å†…å­˜è¦å¿«**ï¼Œå› ä¸ºï¼ˆå…¥æ ˆæ—¶ï¼‰åˆ†é…å™¨æ— éœ€ä¸ºå­˜å‚¨æ–°æ•°æ®å»æœç´¢å†…å­˜ç©ºé—´ï¼›å…¶ä½ç½®æ€»æ˜¯åœ¨æ ˆé¡¶ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨å †ä¸Šåˆ†é…å†…å­˜åˆ™éœ€è¦æ›´å¤šçš„å·¥ä½œï¼Œè¿™æ˜¯å› ä¸ºåˆ†é…å™¨å¿…é¡»é¦–å…ˆæ‰¾åˆ°ä¸€å—è¶³å¤Ÿå­˜æ”¾æ•°æ®çš„å†…å­˜ç©ºé—´ï¼Œå¹¶æ¥ç€åšä¸€äº›è®°å½•ä¸ºä¸‹ä¸€æ¬¡åˆ†é…åšå‡†å¤‡ã€‚

**è®¿é—®å †ä¸Šçš„æ•°æ®æ¯”è®¿é—®æ ˆä¸Šçš„æ•°æ®æ…¢**ï¼Œå› ä¸ºå¿…é¡»é€šè¿‡æŒ‡é’ˆæ¥è®¿é—®ã€‚ç°ä»£å¤„ç†å™¨åœ¨å†…å­˜ä¸­è·³è½¬è¶Šå°‘å°±è¶Šå¿«ï¼ˆç¼“å­˜ï¼‰ã€‚



## æ‰€æœ‰æƒè§„åˆ™

---

> 1. Rust ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ª **æ‰€æœ‰è€…**ï¼ˆ*owner*ï¼‰ã€‚
> 2. å€¼åœ¨ä»»ä¸€æ—¶åˆ»æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚
> 3. å½“æ‰€æœ‰è€…ï¼ˆå˜é‡ï¼‰ç¦»å¼€ä½œç”¨åŸŸï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒã€‚



## [å˜é‡ä½œç”¨åŸŸ](https://kaisery.github.io/trpl-zh-cn/ch04-01-what-is-ownership.html#%E5%8F%98%E9%87%8F%E4%BD%9C%E7%94%A8%E5%9F%9F)

---

å†…å­˜åœ¨æ‹¥æœ‰å®ƒçš„å˜é‡ç¦»å¼€ä½œç”¨åŸŸåå°±è¢«è‡ªåŠ¨é‡Šæ”¾ã€‚ä¸‹é¢æ˜¯ç¤ºä¾‹ 4-1 ä¸­ä½œç”¨åŸŸä¾‹å­çš„ä¸€ä¸ªä½¿ç”¨ `String` è€Œä¸æ˜¯å­—ç¬¦ä¸²å­—é¢å€¼çš„ç‰ˆæœ¬ï¼š

```rust
 {
	let s = String::from("hello"); // ä»æ­¤å¤„èµ·ï¼Œs æ˜¯æœ‰æ•ˆçš„

        // ä½¿ç”¨ s
    }                        // æ­¤ä½œç”¨åŸŸå·²ç»“æŸï¼Œ
                            // s ä¸å†æœ‰æ•ˆ
```

è¿™æ˜¯ä¸€ä¸ªå°† `String` éœ€è¦çš„å†…å­˜è¿”å›ç»™åˆ†é…å™¨çš„å¾ˆè‡ªç„¶çš„ä½ç½®ï¼šå½“ `s` ç¦»å¼€ä½œç”¨åŸŸçš„æ—¶å€™ã€‚å½“å˜é‡ç¦»å¼€ä½œç”¨åŸŸï¼ŒRust ä¸ºæˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å«åš [`drop`](https://doc.rust-lang.org/std/ops/trait.Drop.html#tymethod.drop)ï¼Œåœ¨è¿™é‡Œ `String` çš„ä½œè€…å¯ä»¥æ”¾ç½®é‡Šæ”¾å†…å­˜çš„ä»£ç ã€‚Rust åœ¨ç»“å°¾çš„ `}` å¤„è‡ªåŠ¨è°ƒç”¨ `drop`ã€‚

## [Move](https://kaisery.github.io/trpl-zh-cn/ch04-01-what-is-ownership.html#%E5%8F%98%E9%87%8F%E4%B8%8E%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92%E7%9A%84%E6%96%B9%E5%BC%8F%E4%B8%80%E7%A7%BB%E5%8A%A8)

---

~~~rust
    let x = 5;
    let y = x;
~~~

æˆ‘ä»¬å¤§è‡´å¯ä»¥çŒœåˆ°è¿™åœ¨å¹²ä»€ä¹ˆï¼šâ€œå°† `5` ç»‘å®šåˆ° `x`ï¼›æ¥ç€ç”Ÿæˆä¸€ä¸ªå€¼ `x` çš„æ‹·è´å¹¶ç»‘å®šåˆ° `y`â€ã€‚ç°åœ¨æœ‰äº†ä¸¤ä¸ªå˜é‡ï¼Œ`x` å’Œ `y`ï¼Œéƒ½ç­‰äº `5`ã€‚è¿™ä¹Ÿæ­£æ˜¯äº‹å®ä¸Šå‘ç”Ÿäº†çš„ï¼Œå› ä¸ºæ•´æ•°æ˜¯æœ‰å·²çŸ¥å›ºå®šå¤§å°çš„ç®€å•å€¼ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ª `5` è¢«æ”¾å…¥äº†æ ˆä¸­ã€‚



ç°åœ¨çœ‹çœ‹è¿™ä¸ª `String` ç‰ˆæœ¬ï¼š

```rust
    let s1 = String::from("hello");
    let s2 = s1;
```

è¿™çœ‹èµ·æ¥ä¸ä¸Šé¢çš„ä»£ç éå¸¸ç±»ä¼¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯èƒ½ä¼šå‡è®¾å®ƒä»¬çš„è¿è¡Œæ–¹å¼ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼šä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬äºŒè¡Œå¯èƒ½ä¼šç”Ÿæˆä¸€ä¸ª `s1` çš„æ‹·è´å¹¶ç»‘å®šåˆ° `s2` ä¸Šã€‚ä¸è¿‡ï¼Œäº‹å®ä¸Šå¹¶ä¸å®Œå…¨æ˜¯è¿™æ ·ã€‚

`String` ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå¦‚å›¾å·¦ä¾§æ‰€ç¤ºï¼šä¸€ä¸ªæŒ‡å‘å­˜æ”¾å­—ç¬¦ä¸²å†…å®¹å†…å­˜çš„æŒ‡é’ˆï¼Œä¸€ä¸ªé•¿åº¦ï¼Œå’Œä¸€ä¸ªå®¹é‡ã€‚è¿™ä¸€ç»„æ•°æ®å­˜å‚¨åœ¨æ ˆä¸Šã€‚å³ä¾§åˆ™æ˜¯å †ä¸Šå­˜æ”¾å†…å®¹çš„å†…å­˜éƒ¨åˆ†ã€‚

> é•¿åº¦è¡¨ç¤º `String` çš„å†…å®¹å½“å‰ä½¿ç”¨äº†å¤šå°‘å­—èŠ‚çš„å†…å­˜ã€‚å®¹é‡æ˜¯ `String` ä»åˆ†é…å™¨æ€»å…±è·å–äº†å¤šå°‘å­—èŠ‚çš„å†…å­˜ã€‚é•¿åº¦ä¸å®¹é‡çš„åŒºåˆ«æ˜¯å¾ˆé‡è¦çš„ï¼Œä¸è¿‡åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­å¹¶ä¸é‡è¦ï¼Œæ‰€ä»¥ç°åœ¨å¯ä»¥å¿½ç•¥å®¹é‡ã€‚

<img src="https://kaisery.github.io/trpl-zh-cn/img/trpl04-01.svg" alt="String" style="zoom: 25%;" />

å½“æˆ‘ä»¬å°† `s1` èµ‹å€¼ç»™ `s2`ï¼Œ`String` çš„æ•°æ®è¢«å¤åˆ¶äº†ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä»æ ˆä¸Šæ‹·è´äº†å®ƒçš„æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡ã€‚æˆ‘ä»¬å¹¶æ²¡æœ‰å¤åˆ¶æŒ‡é’ˆæŒ‡å‘çš„å †ä¸Šæ•°æ®ã€‚

>  å›¾ 4-2ï¼šå˜é‡ `s2` çš„å†…å­˜è¡¨ç°ï¼Œå®ƒæœ‰ä¸€ä»½ `s1` æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡çš„æ‹·è´

<img src="https://kaisery.github.io/trpl-zh-cn/img/trpl04-02.svg" style="zoom:33%;" />

è¿™ä¸ªè¡¨ç°å½¢å¼çœ‹èµ·æ¥ **å¹¶ä¸åƒ** ä¸‹å›¾ä¸­çš„é‚£æ ·ï¼Œå¦‚æœ Rust ä¹Ÿæ‹·è´äº†å †ä¸Šçš„æ•°æ®ï¼Œé‚£ä¹ˆå†…å­˜çœ‹èµ·æ¥å°±æ˜¯è¿™æ ·çš„ã€‚å¦‚æœ Rust è¿™ä¹ˆåšäº†ï¼Œé‚£ä¹ˆæ“ä½œ `s2 = s1` åœ¨å †ä¸Šæ•°æ®æ¯”è¾ƒå¤§çš„æ—¶å€™ä¼šå¯¹è¿è¡Œæ—¶æ€§èƒ½é€ æˆéå¸¸å¤§çš„å½±å“ã€‚

>  å›¾ 4-3ï¼šå¦‚æœ Rust æ‹·è´äº†å †ä¸Šçš„æ•°æ®çš„è¯

![](https://kaisery.github.io/trpl-zh-cn/img/trpl04-03.svg)

ä¹‹å‰æˆ‘ä»¬æåˆ°è¿‡å½“å˜é‡ç¦»å¼€ä½œç”¨åŸŸåï¼ŒRust è‡ªåŠ¨è°ƒç”¨ `drop` å‡½æ•°å¹¶æ¸…ç†å˜é‡çš„å †å†…å­˜ã€‚ä¸è¿‡å›¾ 4-2 å±•ç¤ºäº†ä¸¤ä¸ªæ•°æ®æŒ‡é’ˆæŒ‡å‘äº†åŒä¸€ä½ç½®ã€‚è¿™å°±æœ‰äº†ä¸€ä¸ªé—®é¢˜ï¼šå½“ `s2` å’Œ `s1` ç¦»å¼€ä½œç”¨åŸŸï¼Œå®ƒä»¬éƒ½ä¼šå°è¯•é‡Šæ”¾ç›¸åŒçš„å†…å­˜ã€‚è¿™æ˜¯ä¸€ä¸ªå«åš **äºŒæ¬¡é‡Šæ”¾**ï¼ˆ*double free*ï¼‰çš„é”™è¯¯ï¼Œä¹Ÿæ˜¯ä¹‹å‰æåˆ°è¿‡çš„å†…å­˜å®‰å…¨æ€§ bug ä¹‹ä¸€ã€‚ä¸¤æ¬¡é‡Šæ”¾ï¼ˆç›¸åŒï¼‰å†…å­˜ä¼šå¯¼è‡´å†…å­˜æ±¡æŸ“ï¼Œå®ƒå¯èƒ½ä¼šå¯¼è‡´æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚

ä¸ºäº†ç¡®ä¿å†…å­˜å®‰å…¨ï¼Œåœ¨ `let s2 = s1;` ä¹‹åï¼ŒRust è®¤ä¸º `s1` ä¸å†æœ‰æ•ˆï¼Œå› æ­¤ Rust ä¸éœ€è¦åœ¨ `s1` ç¦»å¼€ä½œç”¨åŸŸåæ¸…ç†ä»»ä½•ä¸œè¥¿ã€‚çœ‹çœ‹åœ¨ `s2` è¢«åˆ›å»ºä¹‹åå°è¯•ä½¿ç”¨ `s1` ä¼šå‘ç”Ÿä»€ä¹ˆ:

~~~rust
    let s1 = String::from("hello");
    let s2 = s1;

    println!("{}, world!", s1);
~~~

ä½ ä¼šå¾—åˆ°ä¸€ä¸ªç±»ä¼¼å¦‚ä¸‹çš„é”™è¯¯ï¼Œå› ä¸º Rust ç¦æ­¢ä½ ä½¿ç”¨æ— æ•ˆçš„å¼•ç”¨ã€‚

~~~cmd
$ cargo run
   Compiling ownership v0.1.0 (file:///projects/ownership)
error[E0382]: borrow of moved value: `s1`
 --> src/main.rs:5:28
  |
2 |     let s1 = String::from("hello");
  |         -- move occurs because `s1` has type `String`, which does not implement the `Copy` trait
3 |     let s2 = s1;
  |              -- value moved here
4 |
5 |     println!("{}, world!", s1);
  |                            ^^ value borrowed here after move
  |
  = note: this error originates in the macro `$crate::format_args_nl` which comes from the expansion of the macro `println` (in Nightly builds, run with -Z macro-backtrace for more info)

For more information about this error, try `rustc --explain E0382`.
error: could not compile `ownership` due to previous error

~~~

ä¸Šé¢çš„ä¾‹å­å¯ä»¥è§£è¯»ä¸º `s1` è¢« **ç§»åŠ¨** åˆ°äº† `s2` ä¸­ã€‚é‚£ä¹ˆå…·ä½“å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå¦‚å›¾ 4-4 æ‰€ç¤ºã€‚

> å›¾ 4-4ï¼š`s1` æ— æ•ˆä¹‹åçš„å†…å­˜è¡¨ç°

![](https://kaisery.github.io/trpl-zh-cn/img/trpl04-04.svg)

æ€»ç»“: åœ¨Rustä¸­, å½“ä¸€ä¸ªå˜é‡s1æŒ‡å‘å †å†…å­˜çš„æ—¶å€™, s1å°†æ‹¥æœ‰è¯¥å†…å­˜çš„æ‰€æœ‰æƒ, å¦‚æœæ­¤æ—¶æˆ‘ä»¬ä»¤s2=s1, åˆ™è¯¥å†…å­˜å˜ä¸ºs2æ‰€æœ‰, s1è¢«æ— æ•ˆåŒ–, è¿™ä¸ªè¿‡ç¨‹åœ¨Rustä¸­ç§°ä¸º`Move` . 

å¦‚æœæ­¤æ—¶è¯•å›¾è®¿é—®s1, ç¼–è¯‘å™¨ä¼šæŠ¥é”™.

## Clone

---

å¦‚æœæˆ‘ä»¬ **ç¡®å®** éœ€è¦æ·±åº¦å¤åˆ¶ `String` ä¸­å †ä¸Šçš„æ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯æ ˆä¸Šçš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå«åš `clone` çš„é€šç”¨å‡½æ•°ã€‚ç¬¬äº”ç« ä¼šè®¨è®ºæ–¹æ³•è¯­æ³•ï¼Œä¸è¿‡å› ä¸ºæ–¹æ³•åœ¨å¾ˆå¤šè¯­è¨€ä¸­æ˜¯ä¸€ä¸ªå¸¸è§åŠŸèƒ½ï¼Œæ‰€ä»¥ä¹‹å‰ä½ å¯èƒ½å·²ç»è§è¿‡äº†ã€‚

è¿™æ˜¯ä¸€ä¸ªå®é™…ä½¿ç”¨ `clone` æ–¹æ³•çš„ä¾‹å­ï¼š

```rust
    let s1 = String::from("hello");
    let s2 = s1.clone();

    println!("s1 = {}, s2 = {}", s1, s2);
```

è¿™æ®µä»£ç èƒ½æ­£å¸¸è¿è¡Œï¼Œå¹¶ä¸”æ˜ç¡®äº§ç”Ÿå›¾ 4-3 ä¸­è¡Œä¸ºï¼Œè¿™é‡Œå †ä¸Šçš„æ•°æ® **ç¡®å®** è¢«å¤åˆ¶äº†ã€‚

å½“å‡ºç° `clone` è°ƒç”¨æ—¶ï¼Œä½ çŸ¥é“ä¸€äº›ç‰¹å®šçš„ä»£ç è¢«æ‰§è¡Œè€Œä¸”è¿™äº›ä»£ç å¯èƒ½ç›¸å½“æ¶ˆè€—èµ„æºã€‚ä½ å¾ˆå®¹æ˜“å¯Ÿè§‰åˆ°ä¸€äº›ä¸å¯»å¸¸çš„äº‹æƒ…æ­£åœ¨å‘ç”Ÿã€‚

## Copy

---

å½“ä¸€ä¸ªå˜é‡çš„ç±»å‹æ˜¯[æ ‡é‡](##Scalaræ ‡é‡)æ—¶, æŠŠå®ƒèµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡æ—¶ä¸ä¼šæœ‰`Move`è¡Œä¸º

~~~rust
    let x = 5;
    let y = x;
    println!("x = {}, y = {}", x, y);	//æ­£å¸¸è¾“å‡º
~~~

åŸå› æ˜¯åƒæ ‡é‡è¿™æ ·çš„åœ¨ç¼–è¯‘æ—¶å·²çŸ¥å¤§å°çš„ç±»å‹è¢«æ•´ä¸ªå­˜å‚¨åœ¨æ ˆä¸Šï¼Œæ‰€ä»¥æ‹·è´å…¶å®é™…çš„å€¼æ˜¯å¿«é€Ÿçš„, ä½æˆæœ¬çš„ã€‚è¿™æ„å‘³ç€æ²¡æœ‰ç†ç”±åœ¨åˆ›å»ºå˜é‡ `y` åä½¿ `x` æ— æ•ˆã€‚



## Copy&Drop

---

Rust æœ‰ä¸€ä¸ªå«åš `Copy` trait çš„ç‰¹æ®Šæ³¨è§£ï¼Œå¯ä»¥ç”¨åœ¨ç±»ä¼¼æ•´å‹è¿™æ ·çš„å­˜å‚¨åœ¨æ ˆä¸Šçš„ç±»å‹ä¸Šï¼ˆ[ç¬¬åç« ](https://kaisery.github.io/trpl-zh-cn/ch10-00-generics.html)å°†ä¼šè¯¦ç»†è®²è§£ traitï¼‰ã€‚å¦‚æœä¸€ä¸ªç±»å‹å®ç°äº† `Copy` traitï¼Œé‚£ä¹ˆä¸€ä¸ªæ—§çš„å˜é‡åœ¨å°†å…¶èµ‹å€¼ç»™å…¶ä»–å˜é‡åä»ç„¶å¯ç”¨ã€‚

Rust ä¸å…è®¸è‡ªèº«æˆ–å…¶ä»»ä½•éƒ¨åˆ†å®ç°äº† `Drop` trait çš„ç±»å‹ä½¿ç”¨ `Copy` traitã€‚å¦‚æœæˆ‘ä»¬å¯¹å…¶å€¼ç¦»å¼€ä½œç”¨åŸŸæ—¶éœ€è¦ç‰¹æ®Šå¤„ç†çš„ç±»å‹ä½¿ç”¨ `Copy` æ³¨è§£ï¼Œå°†ä¼šå‡ºç°ä¸€ä¸ªç¼–è¯‘æ—¶é”™è¯¯ã€‚è¦å­¦ä¹ å¦‚ä½•ä¸ºä½ çš„ç±»å‹æ·»åŠ  `Copy` æ³¨è§£ä»¥å®ç°è¯¥ traitï¼Œè¯·é˜…è¯»é™„å½• C ä¸­çš„ [â€œå¯æ´¾ç”Ÿçš„ traitâ€](https://kaisery.github.io/trpl-zh-cn/appendix-03-derivable-traits.html)ã€‚

é‚£ä¹ˆå“ªäº›ç±»å‹å®ç°äº† `Copy` trait å‘¢ï¼Ÿä½ å¯ä»¥æŸ¥çœ‹ç»™å®šç±»å‹çš„æ–‡æ¡£æ¥ç¡®è®¤ï¼Œä¸è¿‡ä½œä¸ºä¸€ä¸ªé€šç”¨çš„è§„åˆ™ï¼Œä»»ä½•ä¸€ç»„ç®€å•æ ‡é‡å€¼çš„ç»„åˆéƒ½å¯ä»¥å®ç° `Copy`ï¼Œä»»ä½•ä¸éœ€è¦åˆ†é…å†…å­˜æˆ–æŸç§å½¢å¼èµ„æºçš„ç±»å‹éƒ½å¯ä»¥å®ç° `Copy` ã€‚å¦‚ä¸‹æ˜¯ä¸€äº› `Copy` çš„ç±»å‹ï¼š

- æ‰€æœ‰æ•´æ•°ç±»å‹ï¼Œæ¯”å¦‚ `u32`ã€‚
- å¸ƒå°”ç±»å‹ï¼Œ`bool`ï¼Œå®ƒçš„å€¼æ˜¯ `true` å’Œ `false`ã€‚
- æ‰€æœ‰æµ®ç‚¹æ•°ç±»å‹ï¼Œæ¯”å¦‚ `f64`ã€‚
- å­—ç¬¦ç±»å‹ï¼Œ`char`ã€‚
- å…ƒç»„ï¼Œå½“ä¸”ä»…å½“å…¶åŒ…å«çš„ç±»å‹ä¹Ÿéƒ½å®ç° `Copy` çš„æ—¶å€™ã€‚æ¯”å¦‚ï¼Œ`(i32, i32)` å®ç°äº† `Copy`ï¼Œä½† `(i32, String)` å°±æ²¡æœ‰ã€‚

 ## æ‰€æœ‰æƒä¸å‡½æ•°

---

â€‹	å°†å€¼ä¼ é€’ç»™å‡½æ•°ä¸ç»™å˜é‡èµ‹å€¼çš„åŸç†ç›¸ä¼¼ã€‚å‘å‡½æ•°ä¼ é€’å€¼å¯èƒ½ä¼šç§»åŠ¨æˆ–è€…å¤åˆ¶ï¼Œå°±åƒèµ‹å€¼è¯­å¥ä¸€æ ·ã€‚

~~~rust
fn main() {
    let s = String::from("hello");  // s è¿›å…¥ä½œç”¨åŸŸ

    takes_ownership(s);        // s çš„Moveåˆ°å‡½æ•°é‡Œ ...
                               // ... æ‰€ä»¥åˆ°è¿™é‡Œä¸å†æœ‰æ•ˆ

    let x = 5;                 // x è¿›å…¥ä½œç”¨åŸŸ

    makes_copy(x);             // x åº”è¯¥ç§»åŠ¨å‡½æ•°é‡Œï¼Œ
                               // ä½† i32 æ˜¯ Copy çš„ï¼Œ
                               // æ‰€ä»¥Copyäº†ä¸€ä»½åˆ°å‡½æ•°é‡Œ

} //xå…ˆç§»å‡ºäº†ä½œç”¨åŸŸ, å ç”¨çš„å†…å­˜(åœ¨æ ˆä¸Š)è¢«é‡Šæ”¾. ç„¶åæ˜¯sã€‚ä½†å› ä¸ºsä¸
  //å†æ‹¥æœ‰ä»»ä½•æ‰€æœ‰æƒ,æ‰€ä»¥ä»€ä¹ˆä¹Ÿä¸ä¼šå‘ç”Ÿ.

fn takes_ownership(some_string: String) { // some_string è¿›å…¥ä½œç”¨åŸŸ
    println!("{}", some_string);
} // è¿™é‡Œï¼Œsome_string ç§»å‡ºä½œç”¨åŸŸå¹¶è°ƒç”¨ `drop` æ–¹æ³•ã€‚
  // å ç”¨çš„å†…å­˜è¢«é‡Šæ”¾

fn makes_copy(some_integer: i32) { // some_integer è¿›å…¥ä½œç”¨åŸŸ
    println!("{}", some_integer);
} // è¿™é‡Œï¼Œsome_integer ç§»å‡ºä½œç”¨åŸŸã€‚æ²¡æœ‰ç‰¹æ®Šä¹‹å¤„
~~~

## [è¿”å›å€¼ä¸ä½œç”¨åŸŸ](https://kaisery.github.io/trpl-zh-cn/ch04-01-what-is-ownership.html#%E8%BF%94%E5%9B%9E%E5%80%BC%E4%B8%8E%E4%BD%9C%E7%94%A8%E5%9F%9F)

---



# å¼•ç”¨

**å¼•ç”¨**ï¼ˆ*reference*ï¼‰åƒä¸€ä¸ªæŒ‡é’ˆï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªåœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥ç”±æ­¤è®¿é—®å‚¨å­˜äºè¯¥åœ°å€çš„å±äºå…¶ä»–å˜é‡çš„æ•°æ®ã€‚ ==ä¸æŒ‡é’ˆä¸åŒï¼Œå¼•ç”¨ç¡®ä¿æŒ‡å‘æŸä¸ªç‰¹å®šç±»å‹çš„æœ‰æ•ˆå€¼==ã€‚

å¼•ç”¨å¯ä»¥åšåˆ°ä½¿ç”¨è¯¥å˜é‡çš„å€¼ä½†ä¸è·å¾—è¯¥å˜é‡çš„æ‰€æœ‰æƒ.

[å¼•ç”¨ä¸å€Ÿç”¨](https://kaisery.github.io/trpl-zh-cn/ch04-02-references-and-borrowing.html#%E5%BC%95%E7%94%A8%E4%B8%8E%E5%80%9F%E7%94%A8)

> ä¸ä½¿ç”¨å¼•ç”¨

~~~rust
fu main(){
    let a=String::from("Hello");
    take_ownership(a);
    println!("{}",a);	//ç¼–è¯‘ä¸é€šè¿‡,açš„æ‰€æœ‰æƒå·²è¢«moveç»™take_ownershipå‡½æ•°,å‡½æ•°ç»“æŸåè¢«é”€æ¯.
}

fn take_ownership(some_string: String) {
    println!("{}", some_string);
}
~~~

> ä½¿ç”¨å¼•ç”¨

~~~rust
fu main(){
    let a=String::from("Hello");
    just_borrow(&a);
    println!("{}",a);	//ç¼–è¯‘é€šè¿‡,å‡½æ•°åªæ˜¯å€Ÿç”¨açš„å€¼,ä¸æ”¹å˜æ‰€æœ‰æƒ
}

fn just_borrow(some_string: &String) {
    println!("{}", some_string);
}
~~~

æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå¼•ç”¨çš„è¡Œä¸ºç§°ä¸º **å€Ÿç”¨**ï¼ˆ*borrowing*ï¼‰ã€‚æ­£å¦‚ç°å®ç”Ÿæ´»ä¸­ï¼Œå¦‚æœä¸€ä¸ªäººæ‹¥æœ‰æŸæ ·ä¸œè¥¿ï¼Œä½ å¯ä»¥ä»ä»–é‚£é‡Œå€Ÿæ¥ã€‚å½“ä½ ä½¿ç”¨å®Œæ¯•ï¼Œå¿…é¡»è¿˜å›å»ã€‚æˆ‘ä»¬å¹¶ä¸æ‹¥æœ‰å®ƒã€‚



## å¯å˜å¼•ç”¨

---

å¼•ç”¨é»˜è®¤ä¸èƒ½ä¿®æ”¹å¼•ç”¨çš„å€¼

~~~rust
fn main() {
    let s = String::from("hello");
    change(&s);
}

fn change(some_string: &String) {
    some_string.push_str(", world");	//ç¼–è¯‘ä¸é€šè¿‡
}
~~~

è¿™é‡Œæ˜¯é”™è¯¯ï¼š

```console
$ cargo run
   Compiling ownership v0.1.0 (file:///projects/ownership)
error[E0596]: cannot borrow `*some_string` as mutable, as it is behind a `&` reference
 --> src/main.rs:8:5
  |
7 | fn change(some_string: &String) {
  |                        ------- help: consider changing this to be a mutable reference: `&mut String`
8 |     some_string.push_str(", world");
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ `some_string` is a `&` reference, so the data it refers to cannot be borrowed as mutable
```

æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå°è°ƒæ•´å°±èƒ½ä¿®å¤è¿™ä¸ªé”™è¯¯ï¼Œå…è®¸æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸ªå€Ÿç”¨çš„å€¼ï¼Œè¿™å°±æ˜¯ **å¯å˜å¼•ç”¨**ï¼ˆ*mutable reference*ï¼‰ï¼š

```rust
fn main() {
    let mut s = String::from("hello");
    change(&mut s);
}

fn change(some_string: &mut String) {
    some_string.push_str(", world");
}
```

é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»å°† `s` æ”¹ä¸º `mut`ã€‚ç„¶ååœ¨è°ƒç”¨ `change` å‡½æ•°çš„åœ°æ–¹åˆ›å»ºä¸€ä¸ªå¯å˜å¼•ç”¨ `&mut s`ï¼Œå¹¶æ›´æ–°å‡½æ•°ç­¾åä»¥æ¥å—ä¸€ä¸ªå¯å˜å¼•ç”¨ `some_string: &mut String`ã€‚è¿™å°±éå¸¸æ¸…æ¥šåœ°è¡¨æ˜ï¼Œ`change` å‡½æ•°å°†æ”¹å˜å®ƒæ‰€å€Ÿç”¨çš„å€¼ã€‚

## [æ‚¬å‚å¼•ç”¨](https://kaisery.github.io/trpl-zh-cn/ch04-02-references-and-borrowing.html#%E6%82%AC%E5%9E%82%E5%BC%95%E7%94%A8dangling-references)

---



## å¼•ç”¨çš„è§„åˆ™

---

è®©æˆ‘ä»¬æ¦‚æ‹¬ä¸€ä¸‹ä¹‹å‰å¯¹å¼•ç”¨çš„è®¨è®ºï¼š

- åœ¨ä»»æ„ç»™å®šæ—¶é—´ï¼Œ**è¦ä¹ˆ** åªèƒ½æœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨ï¼Œ**è¦ä¹ˆ** åªèƒ½æœ‰å¤šä¸ªä¸å¯å˜å¼•ç”¨ã€‚
- å¼•ç”¨å¿…é¡»æ€»æ˜¯æœ‰æ•ˆçš„ã€‚



# åˆ‡ç‰‡(Slice)

## [å­—ç¬¦ä¸²Slice](https://kaisery.github.io/trpl-zh-cn/ch04-03-slices.html#%E5%AD%97%E7%AC%A6%E4%B8%B2-slice)

---

å­—ç¬¦ä¸² sliceçš„ç±»å‹å£°æ˜å†™ä½œ `&str`

## [å…¶ä»–ç±»å‹çš„Slice](https://kaisery.github.io/trpl-zh-cn/ch04-03-slices.html#%E5%85%B6%E4%BB%96%E7%B1%BB%E5%9E%8B%E7%9A%84-slice)



# ç»“æ„ä½“

[ç»“æ„ä½“ç›¸å…³](https://kaisery.github.io/trpl-zh-cn/ch05-01-defining-structs.html#%E7%BB%93%E6%9E%84%E4%BD%93%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E5%AE%9E%E4%BE%8B%E5%8C%96)





# æšä¸¾

## [æšä¸¾å®šä¹‰](https://kaisery.github.io/trpl-zh-cn/ch06-01-defining-an-enum.html)



## [Optionæšä¸¾](https://kaisery.github.io/trpl-zh-cn/ch06-01-defining-an-enum.html#option-%E6%9E%9A%E4%B8%BE%E5%92%8C%E5%85%B6%E7%9B%B8%E5%AF%B9%E4%BA%8E%E7%A9%BA%E5%80%BC%E7%9A%84%E4%BC%98%E5%8A%BF)

Rustä¸­æ²¡æœ‰Null, ç”±Optionæšä¸¾ä»£æ›¿Nullçš„åŠŸèƒ½, å…¶å®šä¹‰å¦‚ä¸‹:

~~~rust
enum Option<T> {
    None,
    Some(T),
}
~~~

![image-20240503230301755](./imgs/image-20240503230301755.png)



# match

[match](https://kaisery.github.io/trpl-zh-cn/ch06-02-match.html)



# Rusté¡¹ç›®ç»„ç»‡

ust æœ‰è®¸å¤šåŠŸèƒ½å¯ä»¥è®©ä½ ç®¡ç†ä»£ç çš„ç»„ç»‡ï¼ŒåŒ…æ‹¬å“ªäº›å†…å®¹å¯ä»¥è¢«å…¬å¼€ï¼Œå“ªäº›å†…å®¹ä½œä¸ºç§æœ‰éƒ¨åˆ†ï¼Œä»¥åŠç¨‹åºæ¯ä¸ªä½œç”¨åŸŸä¸­çš„åå­—ã€‚è¿™äº›åŠŸèƒ½ï¼Œæœ‰æ—¶è¢«ç»Ÿç§°ä¸º â€œæ¨¡å—ç³»ç»Ÿï¼ˆthe module systemï¼‰â€ï¼ŒåŒ…æ‹¬ï¼š

- **åŒ…**ï¼ˆ*Packages*ï¼‰ï¼šCargo çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå…è®¸ä½ æ„å»ºã€æµ‹è¯•å’Œåˆ†äº« crateã€‚
- **Crates** ï¼šä¸€ä¸ªæ¨¡å—çš„æ ‘å½¢ç»“æ„ï¼Œå®ƒå½¢æˆäº†åº“æˆ–äºŒè¿›åˆ¶é¡¹ç›®ã€‚
- **æ¨¡å—**ï¼ˆ*Modules*ï¼‰å’Œ **use**ï¼šå…è®¸ä½ æ§åˆ¶ä½œç”¨åŸŸå’Œè·¯å¾„çš„ç§æœ‰æ€§ã€‚
- **è·¯å¾„**ï¼ˆ*path*ï¼‰ï¼šä¸€ä¸ªå‘½åä¾‹å¦‚ç»“æ„ä½“ã€å‡½æ•°æˆ–æ¨¡å—ç­‰é¡¹çš„æ–¹å¼



## [åŒ…å’ŒCrate](https://kaisery.github.io/trpl-zh-cn/ch07-01-packages-and-crates.html#%E5%8C%85%E5%92%8C-crate)

---

*åŒ…*ï¼ˆ*package*ï¼‰æ˜¯æä¾›ä¸€ç³»åˆ—åŠŸèƒ½çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ª crateã€‚ä¸€ä¸ªåŒ…ä¼šåŒ…å«ä¸€ä¸ª *Cargo.toml* æ–‡ä»¶ï¼Œé˜è¿°å¦‚ä½•å»æ„å»ºè¿™äº› crateã€‚

ä½¿ç”¨`cargo new`å‘½ä»¤åˆ›å»ºå‡ºæ¥çš„å°±æ˜¯ä¸€ä¸ªpackage

<img src="./imgs/image-20240504000116273.png" alt="image-20240504000116273" style="zoom:50%;" />



crateåˆ†ä¸¤ç§:

- binary crate--å¯ä»¥è¢«ç¼–è¯‘ä¸ºå¯æ‰§è¡Œç¨‹åº,å¿…é¡»æœ‰ä¸€ä¸ª `main` å‡½æ•°æ¥å®šä¹‰å½“ç¨‹åºè¢«æ‰§è¡Œçš„æ—¶å€™æ‰€éœ€è¦åšçš„äº‹æƒ…
- library crate--æ²¡æœ‰ `main` å‡½æ•°ï¼Œä¹Ÿä¸ä¼šç¼–è¯‘ä¸ºå¯æ‰§è¡Œç¨‹åº, ä½œç”¨æ˜¯ä¸ºå…¶ä»–é¡¹ç›®æä¾›å¯ç”¨çš„å‡½æ•°ç­‰åŠŸèƒ½(ç±»ä¼¼äºjsé‡Œä¸‹è½½çš„åŒ…),å¤§å¤šæ•°æ—¶é—´ crate æŒ‡çš„éƒ½æ˜¯åº“ï¼Œ

åŒ…ä¸­å¯ä»¥åŒ…å«è‡³å¤šä¸€ä¸ªåº“ crate(library crate)ã€‚åŒ…ä¸­å¯ä»¥åŒ…å«ä»»æ„å¤šä¸ªäºŒè¿›åˆ¶ crate(binary crate)ï¼Œä½†æ˜¯å¿…é¡»è‡³å°‘åŒ…å«ä¸€ä¸ª crateï¼ˆæ— è®ºæ˜¯åº“çš„è¿˜æ˜¯äºŒè¿›åˆ¶çš„ï¼‰ã€‚

Cargo ä¼šç»™æˆ‘ä»¬çš„åŒ…åˆ›å»ºä¸€ä¸ª *Cargo.toml* æ–‡ä»¶ã€‚æŸ¥çœ‹ *Cargo.toml* çš„å†…å®¹ï¼Œä¼šå‘ç°å¹¶æ²¡æœ‰æåˆ° *src/main.rs*ï¼Œå› ä¸º Cargo éµå¾ªçš„ä¸€ä¸ªçº¦å®šï¼š*src/main.rs* å°±æ˜¯ä¸€ä¸ªä¸åŒ…åŒåçš„äºŒè¿›åˆ¶ crate çš„ crate æ ¹ã€‚åŒæ ·çš„ï¼ŒCargo çŸ¥é“å¦‚æœåŒ…ç›®å½•ä¸­åŒ…å« *src/lib.rs*ï¼Œåˆ™åŒ…å¸¦æœ‰ä¸å…¶åŒåçš„åº“ crateï¼Œä¸” *src/lib.rs* æ˜¯ crate æ ¹ã€‚crate æ ¹æ–‡ä»¶å°†ç”± Cargo ä¼ é€’ç»™ `rustc` æ¥å®é™…æ„å»ºåº“æˆ–è€…äºŒè¿›åˆ¶é¡¹ç›®ã€‚

åœ¨æ­¤ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªåªåŒ…å« *src/main.rs* çš„åŒ…ï¼Œæ„å‘³ç€å®ƒåªå«æœ‰ä¸€ä¸ªåä¸º `my-project` çš„äºŒè¿›åˆ¶ crateã€‚å¦‚æœä¸€ä¸ªåŒ…åŒæ—¶å«æœ‰ *src/main.rs* å’Œ *src/lib.rs*ï¼Œåˆ™å®ƒæœ‰ä¸¤ä¸ª crateï¼šä¸€ä¸ªäºŒè¿›åˆ¶çš„å’Œä¸€ä¸ªåº“çš„ï¼Œä¸”åå­—éƒ½ä¸åŒ…ç›¸åŒã€‚é€šè¿‡å°†æ–‡ä»¶æ”¾åœ¨ *src/bin* ç›®å½•ä¸‹ï¼Œä¸€ä¸ªåŒ…å¯ä»¥æ‹¥æœ‰å¤šä¸ªäºŒè¿›åˆ¶ crateï¼šæ¯ä¸ª *src/bin* ä¸‹çš„æ–‡ä»¶éƒ½ä¼šè¢«ç¼–è¯‘æˆä¸€ä¸ªç‹¬ç«‹çš„äºŒè¿›åˆ¶ crateã€‚



## crateç»“æ„

---

[crate](https://kaisery.github.io/trpl-zh-cn/ch07-02-defining-modules-to-control-scope-and-privacy.html#%E6%A8%A1%E5%9D%97%E5%B0%8F%E6%8A%84)

[module](https://kaisery.github.io/trpl-zh-cn/ch07-02-defining-modules-to-control-scope-and-privacy.html#%E5%9C%A8%E6%A8%A1%E5%9D%97%E4%B8%AD%E5%AF%B9%E7%9B%B8%E5%85%B3%E4%BB%A3%E7%A0%81%E8%BF%9B%E8%A1%8C%E5%88%86%E7%BB%84)



## è®¿é—®æƒé™

---

[å¼•ç”¨module](https://kaisery.github.io/trpl-zh-cn/ch07-03-paths-for-referring-to-an-item-in-the-module-tree.html)

æ¨¡å—å†…éƒ¨çš„å†…å®¹é»˜è®¤ç§æœ‰, å¤–éƒ¨ä¸å¯è®¿é—®, éœ€è¦ä½¿ç”¨`pub`å…³é”®å­—æ¥æš´éœ²å¯¹å¤–å¯ç”¨çš„å†…å®¹. å¦å¤–, å³ä½¿ä¸€ä¸ª`mod`æ˜¯`pub`çš„, å…¶å†…å®¹ä¹Ÿè¿˜æ˜¯ç§æœ‰çš„, éœ€è¦ä½¿ç”¨`pub`æš´éœ²å‡ºæ¥.

### [ç»“æ„ä½“å’Œæšä¸¾](https://kaisery.github.io/trpl-zh-cn/ch07-03-paths-for-referring-to-an-item-in-the-module-tree.html#%E5%88%9B%E5%BB%BA%E5%85%AC%E6%9C%89%E7%9A%84%E7%BB%93%E6%9E%84%E4%BD%93%E5%92%8C%E6%9E%9A%E4%B8%BE)

---

å¦‚æœæˆ‘ä»¬åœ¨ä¸€ä¸ªç»“æ„ä½“å®šä¹‰çš„å‰é¢ä½¿ç”¨äº† `pub` ï¼Œè¿™ä¸ªç»“æ„ä½“ä¼šå˜æˆå…¬æœ‰çš„ï¼Œä½†æ˜¯è¿™ä¸ªç»“æ„ä½“çš„å­—æ®µä»ç„¶æ˜¯ç§æœ‰çš„, è¦ä½¿ç”¨`pub`æ¥å°†å­—æ®µè®¾ç½®ä¸ºå…¬æœ‰. å½“å…¬æœ‰çš„structæœ‰ç§æœ‰å­—æ®µæ—¶, éœ€è¦æä¾›ä¸€ä¸ªå…¬æœ‰çš„å…³è”å‡½æ•°æ¥æ„é€ å®ä¾‹, å¦åˆ™å¤–éƒ¨æ— æ³•åˆ›å»ºå…¶å®ä¾‹, å› ä¸ºè®¿é—®ä¸äº†ç§æœ‰å­—æ®µ. 

[å…³è”å‡½æ•°](https://kaisery.github.io/trpl-zh-cn/ch05-03-method-syntax.html) 

æšä¸¾åˆ™æ˜¯ä¾‹å¤–,å¦‚æœå°†æšä¸¾è®¾ä¸ºå…¬æœ‰ï¼Œåˆ™å®ƒçš„æ‰€æœ‰æˆå‘˜éƒ½å°†å˜ä¸ºå…¬æœ‰ã€‚



## [é€šè¿‡useå¼•å…¥mod](https://kaisery.github.io/trpl-zh-cn/ch07-04-bringing-paths-into-scope-with-the-use-keyword.html)

---

### [ä½¿ç”¨pub useé‡å¯¼å‡º](https://kaisery.github.io/trpl-zh-cn/ch07-04-bringing-paths-into-scope-with-the-use-keyword.html)



## [æ‹†åˆ†æ¨¡å—](https://kaisery.github.io/trpl-zh-cn/ch07-05-separating-modules-into-different-files.html)

---



# å¸¸è§é›†åˆ

ust æ ‡å‡†åº“ä¸­åŒ…å«ä¸€ç³»åˆ—è¢«ç§°ä¸º **é›†åˆ**ï¼ˆ*collections*ï¼‰çš„éå¸¸æœ‰ç”¨çš„æ•°æ®ç»“æ„ã€‚å¤§éƒ¨åˆ†å…¶ä»–æ•°æ®ç±»å‹éƒ½ä»£è¡¨ä¸€ä¸ªç‰¹å®šçš„å€¼ï¼Œä¸è¿‡é›†åˆå¯ä»¥åŒ…å«å¤šä¸ªå€¼ã€‚ä¸åŒäºå†…å»ºçš„æ•°ç»„å’Œå…ƒç»„ç±»å‹ï¼Œ==è¿™äº›é›†åˆæŒ‡å‘çš„æ•°æ®æ˜¯å‚¨å­˜åœ¨å †ä¸Šçš„==ï¼Œè¿™æ„å‘³ç€æ•°æ®çš„æ•°é‡ä¸å¿…åœ¨ç¼–è¯‘æ—¶å°±å·²çŸ¥ï¼Œå¹¶ä¸”è¿˜å¯ä»¥éšç€ç¨‹åºçš„è¿è¡Œå¢é•¿æˆ–ç¼©å°ã€‚

å¯¹äºæ ‡å‡†åº“æä¾›çš„å…¶ä»–ç±»å‹çš„é›†åˆï¼Œè¯·æŸ¥çœ‹[æ–‡æ¡£](https://doc.rust-lang.org/std/collections/index.html)ã€‚

## vector

---

æˆ‘ä»¬è¦è®²åˆ°çš„ç¬¬ä¸€ä¸ªç±»å‹æ˜¯ `Vec<T>`ï¼Œä¹Ÿè¢«ç§°ä¸º *vector*ã€‚vector å…è®¸æˆ‘ä»¬åœ¨ä¸€ä¸ªå•ç‹¬çš„æ•°æ®ç»“æ„ä¸­å‚¨å­˜å¤šäºä¸€ä¸ªçš„å€¼ï¼Œå®ƒåœ¨å†…å­˜ä¸­å½¼æ­¤ç›¸é‚»åœ°æ’åˆ—æ‰€æœ‰çš„å€¼ã€‚vector åªèƒ½å‚¨å­˜ç›¸åŒç±»å‹çš„å€¼ã€‚

ä¸ºäº†åˆ›å»ºä¸€ä¸ªæ–°çš„ç©º vectorï¼Œå¯ä»¥è°ƒç”¨ `Vec::new` å‡½æ•°

```rust
    let v: Vec<i32> = Vec::new();
```

æ³¨æ„è¿™é‡Œæˆ‘ä»¬å¢åŠ äº†ä¸€ä¸ªç±»å‹æ³¨è§£ã€‚å› ä¸ºæ²¡æœ‰å‘è¿™ä¸ª vector ä¸­æ’å…¥ä»»ä½•å€¼ï¼ŒRust å¹¶ä¸çŸ¥é“æˆ‘ä»¬æƒ³è¦å‚¨å­˜ä»€ä¹ˆç±»å‹çš„å…ƒç´ ã€‚



é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šç”¨åˆå§‹å€¼æ¥åˆ›å»ºä¸€ä¸ª `Vec<T>` è€Œ Rust ä¼šæ¨æ–­å‡ºå‚¨å­˜å€¼çš„ç±»å‹ï¼Œæ‰€ä»¥å¾ˆå°‘ä¼šéœ€è¦è¿™äº›ç±»å‹æ³¨è§£ã€‚ä¸ºäº†æ–¹ä¾¿ Rust æä¾›äº† `vec!` å®ï¼Œè¿™ä¸ªå®ä¼šæ ¹æ®æˆ‘ä»¬æä¾›çš„å€¼æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ vectorã€‚`v`çš„ç±»å‹æ˜¯Vec<i32>ã€‚æ¨æ–­ä¸º `i32` æ˜¯å› ä¸ºè¿™æ˜¯é»˜è®¤æ•´å‹ç±»å‹

```rust
    let v = vec![1, 2, 3];
```

### æ’å…¥

----

å¯¹äºæ–°å»ºä¸€ä¸ª vector å¹¶å‘å…¶å¢åŠ å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ `push` æ–¹æ³•ï¼Œå¦‚ç¤ºä¾‹ 8-3 æ‰€ç¤ºï¼š

```rust
    let mut v = Vec::new();

    v.push(5);
    v.push(6);
    v.push(7);
    v.push(8);
```

å¦‚ç¬¬ä¸‰ç« ä¸­è®¨è®ºçš„ä»»ä½•å˜é‡ä¸€æ ·ï¼Œå¦‚æœæƒ³è¦èƒ½å¤Ÿæ”¹å˜å®ƒçš„å€¼ï¼Œå¿…é¡»ä½¿ç”¨ `mut` å…³é”®å­—ä½¿å…¶å¯å˜ã€‚æ”¾å…¥å…¶ä¸­çš„æ‰€æœ‰å€¼éƒ½æ˜¯ `i32` ç±»å‹çš„ï¼Œè€Œä¸” Rust ä¹Ÿæ ¹æ®æ•°æ®åšå‡ºå¦‚æ­¤åˆ¤æ–­ï¼Œæ‰€ä»¥ä¸éœ€è¦ `Vec<i32>` æ³¨è§£ã€‚

åœ¨æŸä¸ªä½ç½®æ’å…¥, ä½¿ç”¨`insert`æ–¹æ³•



### åˆ é™¤

---

- pop()
- remove()

### è¯»å–

---

[è¯»å–vector](https://kaisery.github.io/trpl-zh-cn/ch08-01-vectors.html#%E8%AF%BB%E5%8F%96-vector-%E7%9A%84%E5%85%83%E7%B4%A0)



### éå†

----

[éå†Vec](https://kaisery.github.io/trpl-zh-cn/ch08-01-vectors.html#%E9%81%8D%E5%8E%86-vector-%E4%B8%AD%E7%9A%84%E5%85%83%E7%B4%A0)

### [ä½¿ç”¨æšä¸¾å­˜å‚¨å¤šç§ç±»å‹](https://kaisery.github.io/trpl-zh-cn/ch08-01-vectors.html#%E4%BD%BF%E7%94%A8%E6%9E%9A%E4%B8%BE%E6%9D%A5%E5%82%A8%E5%AD%98%E5%A4%9A%E7%A7%8D%E7%B1%BB%E5%9E%8B)

---





## string

----





## hash map

---





